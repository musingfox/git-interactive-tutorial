# 07 - 分支的概念

## 什麼是分支？

### 日常生活的類比

想像你在寫一篇文章：

```
原始文章 → 修訂版本1 → 修訂版本2 → 最終版本
     ↓
   實驗版本A → 實驗版本A2
     ↓
   實驗版本B
```

- **主線 (main branch)**：你的正式版本
- **分支 (branch)**：嘗試不同想法的副本
- **合併 (merge)**：把滿意的實驗結果加回主線

### Git 中的分支

分支讓你能夠：
1. **並行開發**：同時進行多個功能
2. **安全實驗**：不影響主要版本
3. **協作分工**：每人負責不同分支
4. **版本管理**：維護不同版本的產品

## 分支的視覺化理解

### 線性開發（沒有分支）
```
A ← B ← C ← D ← E
```
每次都基於前一次提交繼續開發

### 分支開發
```
    main: A ← B ← C ← G ← H
               ↘   ↗
    feature:    D ← E ← F
```

- 從 C 點建立新分支 `feature`
- 在 `feature` 分支上開發 D、E、F
- 將 `feature` 分支合併回 `main`，產生 G
- 繼續在 `main` 上開發 H

## 常見的分支策略

### 1. 功能分支 (Feature Branch)
```
main:     A ← B ← C ← F
               ↘   ↗
login:           D ← E
```
為每個新功能建立分支

### 2. 發布分支 (Release Branch)
```
main:     A ← B ← C ← D ← E
               ↘
release:         C1 ← C2
```
準備發布時建立分支進行最後調整

### 3. 修復分支 (Hotfix Branch)
```
main:     A ← B ← C ← D
               ↘   ↗
hotfix:          H1 ← H2
```
緊急修復重要問題

## 為什麼需要分支？

### 場景1：開發新功能
```
沒有分支的問題：
main: A ← B ← C ← D(半成品) ← E(修正) ← F(完成)

使用分支的解決方案：
main:    A ← B ← C ← G(完整功能)
              ↘   ↗
feature:       D ← E ← F
```

### 場景2：多人協作
```
Alice: main ← A ← B ← C
                   ↘
                    D(Alice的功能)

Bob:   main ← A ← B ← C
                   ↘
                    E(Bob的功能)
```

### 場景3：實驗性開發
```
main:        A ← B ← C ← F
                  ↘   ↗
experiment:        D ← E (實驗成功，合併回來)

main:        A ← B ← C
                  ↘
experiment2:       X (實驗失敗，直接刪除)
```

## Git 中的分支特點

### 1. 輕量級
- 分支只是指向提交的指標
- 建立和切換分支都很快
- 不會複製檔案，只是改變指標

### 2. 本地優先
- 可以在本地建立無數分支
- 只有需要時才推送到遠端

### 3. 非破壞性
- 任何分支操作都不會丟失資料
- 可以隨時恢復或回到之前狀態

## 分支的命名慣例

### 好的分支名稱
- `feature/user-login`：新功能
- `fix/password-bug`：錯誤修復
- `refactor/database-layer`：重構
- `release/v1.2.0`：發布準備

### 避免的分支名稱
- `test`：太模糊
- `my-branch`：不明確用途
- `temp`：臨時性質不明
- `branch1`：數字編號無意義

## 分支的生命週期

### 1. 建立分支
```bash
git branch feature/new-design
```

### 2. 切換到分支
```bash
git checkout feature/new-design
```

### 3. 在分支上開發
```bash
# 修改檔案
git add .
git commit -m "實作新的設計"
```

### 4. 合併回主分支
```bash
git checkout main
git merge feature/new-design
```

### 5. 刪除已完成的分支
```bash
git branch -d feature/new-design
```

## 分支狀態理解

### HEAD 指標
```
main:    A ← B ← C (HEAD 在這裡)
              ↘
feature:       D ← E
```

`HEAD` 指向目前所在的分支和提交。

### 分支指標
每個分支都是指向某個提交的指標：
- `main` 指向 C
- `feature` 指向 E

## 實際思考練習

### 情境1：個人專案
你正在開發一個個人網站，目前有基本結構。現在想要：
- 嘗試新的頁面設計
- 加入聯絡表單功能

你會如何使用分支？

### 情境2：團隊協作
你們團隊正在開發一個應用程式：
- Alice 負責使用者認證
- Bob 負責資料展示
- Charlie 負責 API 整合

你們會如何組織分支？

### 情境3：版本管理
你的應用程式即將發布 1.0 版本，但同時需要：
- 繼續開發 1.1 版本的新功能
- 修正 1.0 版本發現的小問題

你會如何規劃分支？

## 常見誤解澄清

### ❌ 分支會讓事情變複雜
✅ 分支讓複雜的開發變得有組織

### ❌ 分支會佔用很多空間
✅ Git 分支非常輕量，幾乎不佔空間

### ❌ 合併分支很危險
✅ Git 的合併機制很安全，有衝突時會提醒

### ❌ 只有大專案才需要分支
✅ 即使個人專案也能從分支中受益

## 下一步

理解了分支的概念後，讓我們來實際操作：建立、切換和使用分支。

---

**上一章：[查看歷史記錄](../02-basic-operations/viewing-history.md)**  
**下一章：[建立和切換分支](creating-switching.md)**